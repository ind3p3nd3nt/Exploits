CTF'd Server Administrator Account Takeover Vulnerability by Social Engineering Neo.


Tested On: -
Live Remote Hosted CTFd Server.
Local Hosted CTFd Server.


Class: -
Improper Authorization - CWE-285


Base: -
Direct Request 'Forced Browsing' - CWE-425


Summary: -
Due to Improper Authorization Checks and Direct Request Protections, Newly Created CTF'd Servers Have the Potential of a "Full" Administrator Account Takeover During the Setup Process. This Includes the Given URL Prior to and During SETUP/UNTIL "Save-State".


Short Description: -
A remote attacker with knowledge of this new CTF'd hostname could modify critical configurations of the server. This is only possible while the server admin is performing the initial setup.


Proof of Concept: -
####
VICTIM – (Server Admin)
1.) -    Setting up CTF'd server configuration as usual.

ATTACKER
1.) -    Knowledge of newly created CTFd hostname.
2.) -    Access https://[HOST].ctfd.io to verify the server is up.
3.) -    Access https://[HOST].ctfd.io/setup to set/modify server Administrator password, username and email – no authentication/authorization required to input these values
4.) -    Login with new admin credentials at https://[HOST].ctfd.io/login 

[ADMIN USER TAKEOVER SUCCESSFUL]
####

VIDEO: - https://youtu.be/bQyVyXzvHCo


Expected Result: -
Users should not have the ability to read/write critical server/user configuration without proper authentication.


Observed Result: -
Unauthorized users have the ability to read/write critical server/user configuration without any authentication.


Our Recommendation:
Implement direct request (forced browsing) protections during server initialization, this can be done by requiring additional authentication or verify the authorization of users when accessing /setup.


TIMELINE: - Discovery               13th December 2019
        : - CTF'd contact made      13th December 2019
        : - Response                13th December 2019    *Findings Discarded. "The true owner can always contact us (support@ctfd.io) to have administrator password reset"*
        : - Our Response            13th December 2019    *Disclosure date set within 24 hours from initial discovery*

        : - We thank the CTFd support team for their very quick response.
